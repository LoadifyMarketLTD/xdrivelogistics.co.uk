<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Email Verification â€” XDrive Logistics</title>
  <style>
    :root{
      --bg:#051421; --panel:#0b1b24; --muted:#97a6ad; --gold:#D6A551;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui, -apple-system, "Segoe UI", Roboto, Arial; 
      background:linear-gradient(180deg,#04121a,#071b27); color:#eef5f9;
      display:flex; align-items:center; justify-content:center; padding:28px;
    }
    .container{
      max-width:600px; width:100%; padding:40px; border-radius:12px;
      background:linear-gradient(180deg, rgba(10,18,24,0.80), rgba(6,14,18,0.85));
      border:1px solid rgba(255,255,255,0.03);
      box-shadow:0 20px 60px rgba(0,0,0,0.6);
      text-align:center;
    }
    h1{ margin:0 0 20px; font-size:32px; color:#fff; }
    p{ color:var(--muted); line-height:1.6; margin:10px 0; }
    .status{ padding:20px; border-radius:8px; margin:20px 0; }
    .success{ background:#1a3d2a; border:1px solid #2d6a4f; color:#74c38d; }
    .error{ background:#3d1a1a; border:1px solid #8b3737; color:#ff9999; }
    .loading{ color:var(--gold); }
    a{ color:var(--gold); text-decoration:none; font-weight:600; }
    a:hover{ text-decoration:underline; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Email Verification</h1>
    <div id="message" class="status loading">
      <p>Verifying your email address...</p>
    </div>
    <div id="actions" style="display:none; margin-top:30px;">
      <a href="desktop-signin-final.html">Go to Login</a>
    </div>
  </div>

  <script>
    // Get token from URL
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get('token');
    
    async function verifyEmail() {
      const messageDiv = document.getElementById('message');
      const actionsDiv = document.getElementById('actions');
      
      if (!token) {
        messageDiv.className = 'status error';
        messageDiv.innerHTML = '<p>No verification token provided.</p>';
        return;
      }
      
      try {
        const response = await fetch(`http://localhost:3001/api/verify-email?token=${encodeURIComponent(token)}`);
        const data = await response.json();
        
        if (response.ok) {
          messageDiv.className = 'status success';
          messageDiv.innerHTML = `
            <p><strong>Success!</strong></p>
            <p>${data.message}</p>
            <p>Your account has been verified. You can now login.</p>
          `;
          actionsDiv.style.display = 'block';
        } else {
          messageDiv.className = 'status error';
          messageDiv.innerHTML = `
            <p><strong>Verification Failed</strong></p>
            <p>${data.error || 'Unable to verify email. The link may be expired or invalid.'}</p>
          `;
        }
      } catch (err) {
        console.error('Verification error:', err);
        messageDiv.className = 'status error';
        messageDiv.innerHTML = `
          <p><strong>Error</strong></p>
          <p>Unable to connect to the server. Please ensure the backend is running.</p>
        `;
      }
    }
    
    // Verify on page load
    verifyEmail();
  </script>
</body>
</html>
